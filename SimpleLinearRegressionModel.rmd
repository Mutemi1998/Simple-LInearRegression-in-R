#SimpleLinearRegression Model to
#predict Irsis petal width given petal length

#load the dataset
data(iris)

#print the head of the dataset
head(iris)

#create a scatterplot
plot(
      x = iris$Petal.Length,
      y = iris$Petal.Width,
      main = "Iris Petal Length vs Width",
      xlab = "Petal Length (cm)",
      ylab = "Petal Width (cm)"
)


#create a linear model
model <- lm(
          formula =  Petal.Width ~  Petal.Length,
          data = iris)
          
#summary for the model          
summary(model) 

#plot the best fit line
lines(
      x = iris$Petal.Length,
      y = model$fitted,
      col = "red",
      lwd = 3 
)

#correlation co efficient
cor(iris$Petal.Length, iris$Petal.Width)

#predict new values using our new model
predict(
    object = model,
    newdata = data.frame(
    Petal.Length = c(2,5,7))
)
  